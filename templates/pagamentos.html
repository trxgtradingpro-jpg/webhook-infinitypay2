{% extends "layout.html" %}
{% block title %}Pagamentos{% endblock %}

{% block content %}

<!-- ================= HEADER ================= -->
<div class="header">
  <div>
    <h1>Pagamentos</h1>
    <span>Controle financeiro e conciliaÃ§Ã£o</span>
  </div>
</div>

<!-- ================= KPI CARDS ================= -->
<div class="cards">

  <div class="card">
    <h3>Faturamento Total</h3>
    <p>R$ {{ faturamento_total }}</p>
  </div>

  <div class="card">
    <h3>Pagamentos Hoje</h3>
    <p>{{ pagamentos_hoje }}</p>
  </div>

  <div class="card">
    <h3>Ticket MÃ©dio</h3>
    <p>R$ {{ ticket_medio }}</p>
  </div>

  <div class="card">
    <h3>Status do Gateway</h3>
    <p style="color:#22c55e">Online</p>
  </div>

</div>

<!-- ================= CHART ================= -->
<div class="panel">
  <h2>ðŸ“ˆ Faturamento por Dia</h2>
  <canvas id="revenueChart"></canvas>
</div>

<!-- ================= TABLE ================= -->
<div class="panel">
  <h2>ðŸ’µ TransaÃ§Ãµes</h2>

  <table class="table">
    <thead>
      <tr>
        <th>Plano</th>
        <th>Email</th>
        <th>Valor</th>
        <th>MÃ©todo</th>
        <th>Status</th>
        <th>Data</th>
      </tr>
    </thead>

    <tbody>
      {% for p in pagamentos %}
      <tr>
        <td><strong>{{ p.plano }}</strong></td>
        <td>{{ p.email }}</td>
        <td>R$ {{ p.valor }}</td>
        <td>{{ p.metodo }}</td>
        <td style="color:#22c55e">Pago</td>
        <td>{{ p.data }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- ================= FOOTER ================= -->
<div class="footer">
  Â© 2026 TRX Trading â€¢ Financeiro
</div>

<!-- ================= JS ================= -->
<script>
document.addEventListener("DOMContentLoaded", function () {

  const ctx = document.getElementById("revenueChart");
  if (!ctx) return;

  new Chart(ctx, {
    type: "bar",
    data: {
      labels: {{ chart_labels | safe }},
      datasets: [{
        label: "Faturamento",
        data: {{ chart_values | safe }},
        backgroundColor: "rgba(34,197,94,.6)",
        borderRadius: 8
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { display: false }
      },
      scales: {
        y: {
          grid: { color: "#1f2937" },
          ticks: { color: "#9ca3af" }
        },
        x: {
          grid: { display: false },
          ticks: { color: "#9ca3af" }
        }
      }
    }
  });

});
</script>

{% endblock %}
